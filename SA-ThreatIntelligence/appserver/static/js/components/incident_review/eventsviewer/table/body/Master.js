"use strict";define(["module","underscore","views/Base","sa-threatintelligence/js/components/incident_review/eventsviewer/table/body/row/PrimaryRow","sa-threatintelligence/js/components/incident_review/eventsviewer/table/body/row/SecondaryRow","util/console"],function(a,b,c,d,e,f){return c.extend({moduleId:a.id,tagName:"tbody",initialize:function(){c.prototype.initialize.apply(this,arguments),this.fieldNameMapping=this.options.fieldNameMapping,this.primaryRowFields=this.options.primaryRowFields},startListening:function(){this.listenTo(this.model.result.results,"reset",function(){this.model.state.get("isModalized")||this.debouncedCleanupAndRender()})},activate:function(a){var d=b.extend({},a||{});return delete d.deep,this.active?c.prototype.activate.call(this,d):(c.prototype.activate.call(this,d),this.synchronousCleanupAndDebouncedRender(),this)},synchronousCleanupAndDebouncedRender:function(){this.active&&(this.cleanup(),this.debouncedRender())},debouncedCleanupAndRender:b.debounce(function(){this.active&&(this.cleanup(),this.render())},0),cleanup:function(){this.trigger("rows:pre-remove"),this.eachChild(function(a){a.deactivate({deep:!0}),a.debouncedRemove({detach:!0}),a.close()},this),this.children={}},render:function(){if(b.isEmpty(this.children)){var a=document.createDocumentFragment(),c=this.model.searchJob.entry.content.get("isRealTimeSearch"),g=c?this.model.result.results.reverse({mutate:!1}):this.model.result.results.models;f.debug("Events Lister: rendering",g.length,"events",c?"in real-time mode":"in historical mode"),b.each(g,function(b,f){var g;g=c?this.model.result.endOffset()-f:this.model.result.get("init_offset")+f+1,this.children["masterRow_"+f]=new d({model:{event:b,report:this.model.report,application:this.model.application,searchJob:this.model.searchJob,result:this.model.result,state:this.model.state},collection:{eventRenderers:this.collection.eventRenderers,selectedRows:this.collection.selectedRows,workflowActions:this.collection.workflowActions,notableEventSuppressions:this.collection.notableEventSuppressions},lineNum:g,idx:f,allowRowExpand:this.options.allowRowExpand,primaryRowFields:this.primaryRowFields,backboneEventMediator:this.options.backboneEventMediator,filedNameReplacementForActions:this.options.filedNameReplacementForActions,fieldFormating:this.options.fieldFormating}),this.children["masterRow_"+f].render().appendTo(a),this.children["masterRow_"+f].activate({deep:!0}),this.children["fieldRow_"+f]=new e({model:{event:b,report:this.model.report,result:this.model.result,summary:this.model.summary,state:this.model.state,application:this.model.application,searchJob:this.model.searchJob},collection:{workflowActions:this.collection.workflowActions,selectedRows:this.collection.selectedRows},idx:f,selectableFields:this.options.selectableFields,fieldNameMapping:this.fieldNameMapping,colSpan:this.primaryRowFields.length,fieldFormating:this.options.fieldFormating}),this.children["fieldRow_"+f].render().appendTo(a),this.children["fieldRow_"+f].activate({deep:!0})},this),this.el.appendChild(a),b(this.model.state.toJSON()).each(function(a,b){0===b.indexOf("pendingRemove")&&this.model.state.unset(b)},this),this.trigger("rows:added")}return 0!==$("td.col-visibility .ir-label-checkbox").length&&$("td.col-visibility .ir-selected").length===$("td.col-visibility .ir-label-checkbox").length?this.options.backboneEventMediator.trigger("ir-add-select-all-checkbox"):this.options.backboneEventMediator.trigger("ir-remove-select-all-checkbox"),this}})});