"use strict";define(["underscore","backbone","jquery","util/splunkd_utils","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","sa-utils/js/util/Console"],function(a,b,c,d,e,f,g,h){var i="edit-body",j="edit-footer",k=".edit-body",l=".edit-footer",m='<a href="#" role="button" class="btn cancel pull-left" data-dismiss="modal">'+a("Cancel").t()+"</a>",n='<a href="#" role="button" class="btn btn-primary pull-right">'+a("Save").t()+"</a>";return e.extend({template:'\n                <div class="'+i+'"></div>\n                <div class="'+j+'"></div>\n            ',initialize:function(c){c=c||{},this.statuses=c.statuses||[],this.users=c.users||[],this.urgencies=c.urgencies||[],this.domains=c.domains||[],this.message=new b.Model,this.children.rule_title=new g({label:a("Title").t(),required:!0,controlType:"Text",controlOptions:{model:this.model,modelAttribute:"rule_title",placeholder:a("Enter a title for the notable event").t()}}),this.children.domain=new g({label:a("Domain").t(),controlType:"SyntheticSelect",controlOptions:{model:this.model,modelAttribute:"security_domain",items:this.domains}}),this.children.urgency=new g({label:a("Urgency").t(),controlType:"SyntheticSelect",controlOptions:{model:this.model,modelAttribute:"urgency",items:this.urgencies}}),this.children.owner=new g({label:a("Owner").t(),controlType:"SyntheticSelect",controlOptions:{model:this.model,modelAttribute:"owner",items:this.users}}),this.children.status=new g({label:a("Status").t(),controlType:"SyntheticSelect",controlOptions:{model:this.model,modelAttribute:"status",items:this.statuses}}),this.children.rule_description=new g({label:a("Description").t(),required:!0,controlType:"Textarea",controlOptions:{model:this.model,modelAttribute:"rule_description",placeholder:a("Enter the text of the notable event").t()}}),this.children.message=new g({label:"",controlType:"Label",error:!0,controlOptions:{model:this.message,modelAttribute:"errmsg",additionalClassNames:"error"}})},events:{"click a.btn-primary":"save","click a.btn.cancel":"cancel"},setError:function(a){this.message.set("errmsg",a)},startListening:function(){this.listenTo(this.message,"change",function(){var b=this;""!==this.message.get("errmsg")&&!function(){var c=b.children.message,d=b.message;c.show(),a.delay(function(){c.$el.fadeOut(1e3),d.set("errmsg","",{silent:!0})},5e3)}()})},save:function(){var b=this.model,c=this.children;a.each(c,function(a){a.$el.hasClass("error")&&(a.setHelpText(a._helpText),delete a._helpText,a.error(!1,""))});try{if(!b.isValid()){var d=b.validationError;return a.each(d,function(b,d){if(a.has(c,d)){var e=c[d];e.error(!0,b),e._helpText=e.$(".help-block").text(),e.setHelpText(b)}else h.error("Unknown field",d)}),!1}this.trigger("save")}catch(e){h.log(e),h.log(e.stack)}return!1},cancel:function(){return this.trigger("cancel"),!1},setPrimaryButtonState:function(a,b){var c=this.$("a.btn-primary");c.text(a),b===!0&&c.addClass("disable")},resetPrimaryButtonState:function(){var b=this.$("a.btn-primary");b.text(a("Save").t()),b.removeClass("disable")},render:function(){this.$el.html(this.template);var a=this.$(k),b=this.$(l);return this.children.rule_title.render().appendTo(a),this.children.domain.render().appendTo(a),this.children.urgency.render().appendTo(a),this.children.owner.render().appendTo(a),this.children.status.render().appendTo(a),this.children.rule_description.render().appendTo(a),this.children.message.render().appendTo(a),this.children.message.hide(),b.append(m),b.append(n),this}})});