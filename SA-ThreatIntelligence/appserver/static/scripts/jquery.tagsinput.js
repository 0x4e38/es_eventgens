!function(a){var b=new Array;jQuery.fn.addTag=function(c,d){var d=jQuery.extend({focus:!1},d);return this.each(function(){id=a(this).attr("id");var e=a(this).val().split(b[id]);""==e[0]&&(e=new Array),c=jQuery.trim(c),""!=c&&(a('<span class="tag">'+c+'&nbsp;&nbsp;<a href="#" title="Remove tag" onclick="return $(\'#'+id+"').removeTag('"+escape(c)+"');\">x</a></span>").insertBefore("#"+id+"_addTag"),e.push(c),a("#"+id+"_tag").val(""),d.focus?a("#"+id+"_tag").focus():a("#"+id+"_tag").blur()),jQuery.fn.tagsInput.updateTagsField(this,e)}),!1},jQuery.fn.removeTag=function(c){return this.each(function(){id=a(this).attr("id");var d=a(this).val().split(b[id]);for(a("#"+id+"_tagsinput .tag").remove(),str="",i=0;i<d.length;i++)escape(d[i])!=c&&(str=str+b[id]+d[i]);jQuery.fn.tagsInput.importTags(this,str)}),!1},jQuery.fn.tagsInput=function(c){var e=jQuery.extend({defaultText:"add a tag",width:"300px",height:"100px",hide:!0,delimiter:",",autocomplete:{selectFirst:!1}},c);return this.each(function(){e.hide&&a(this).hide(),id=a(this).attr("id"),data=jQuery.extend({pid:id,real_input:"#"+id,holder:"#"+id+"_tagsinput",input_wrapper:"#"+id+"_addTag",fake_input:"#"+id+"_tag"},e),b[id]=data.delimiter,a('<div id="'+id+'_tagsinput" class="tagsinput"><div id="'+id+'_addTag"><input id="'+id+'_tag" value="" default="'+e.defaultText+'" /></div><div class="tags_clear"></div></div>').insertAfter(this),a(data.holder).css("width",e.width),a(data.holder).css("height",e.height),""!=a(data.real_input).val()?jQuery.fn.tagsInput.importTags(a(data.real_input),a(data.real_input).val()):(a(data.fake_input).val(a(data.fake_input).attr("default")),a(data.fake_input).css("color","#666666")),a(data.holder).bind("click",data,function(b){a(b.data.fake_input).focus()}),a(data.fake_input).bind("keypress",data,function(b){if(b.which==b.data.delimiter.charCodeAt(0)||13==b.which)return a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:!0}),!1}),a(data.fake_input).bind("focus",data,function(b){a(b.data.fake_input).val()==a(b.data.fake_input).attr("default")&&a(b.data.fake_input).val(""),a(b.data.fake_input).css("color","#000000")}),void 0!=e.autocomplete_url?(a(data.fake_input).autocomplete(e.autocomplete_url,e.autocomplete).bind("result",data,function(b,c,e){c&&(d=c+"",a(b.data.real_input).addTag(d,{focus:!0}))}),a(data.fake_input).bind("blur",data,function(b){return a(b.data.fake_input).val()!=a(b.data.fake_input).attr("default")&&a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:!1}),a(b.data.fake_input).val(a(b.data.fake_input).attr("default")),a(b.data.fake_input).css("color","#666666"),!1})):a(data.fake_input).bind("blur",data,function(b){var c=a(this).attr("default");return""!=a(b.data.fake_input).val()&&a(b.data.fake_input).val()!=c?(b.preventDefault(),a(b.data.real_input).addTag(a(b.data.fake_input).val(),{focus:!0})):(a(b.data.fake_input).val(a(b.data.fake_input).attr("default")),a(b.data.fake_input).css("color","#666666")),!1}),a(data.fake_input).blur()}),this},jQuery.fn.tagsInput.updateTagsField=function(c,d){id=a(c).attr("id"),a(c).val(d.join(b[id]))},jQuery.fn.tagsInput.importTags=function(c,d){a(c).val(""),id=a(c).attr("id");var e=d.split(b[id]);for(i=0;i<e.length;i++)a(c).addTag(e[i],{focus:!1})}}(jQuery);