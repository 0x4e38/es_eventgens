
#####################
## Threat Intelligence
#####################

## Threat intelligence metadata
## _key = <threat_intel_collection_name>
[threat_intel_meta]
field.time = time


##
# OpenIOC Mappings to certificate_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   alias                               : None
#   certificate_version                 : None
#   certificate_file_hash               : None
#   certificate_handshake_type          : None
#   certificate_issuer                  : None
#   certificate_issuer_common_name      : None
#   certificate_issuer_email            : None
#   certificate_issuer_locality         : None
#   certificate_issuer_organization     : None
#   certificate_issuer_state            : None
#   certificate_issuer_street           : None
#   certificate_issuer_unit             : None
#   certificate_publickey_algorithm     : None
#   certificate_serial                  : None
#   certificate_signature_algorithm     : None
#   certificate_subject                 : None
#   certificate_subject_common_name     : None
#   certificate_subject_email           : None
#   certificate_subject_locality        : None
#   certificate_subject_organization    : None
#   certificate_subject_state           : None
#   certificate_subject_street          : None
#   certificate_subject_unit            : None
#   certificate_supported_next_protocol : None
#   certificate_end_time                : None
#   certificate_start_time              : None
#   ip                                  : None
#   domain                              : None
#   threat_key                          : Derived from input definition or <links> object in IOC
#   time                                : Derived at time the IOC is processed.
##

##
# STIX Mappings to certificate_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- X509CertificateObj:X509CertificateObjectType { X509Certificate(ObjectProperties) }
#    * alias                                 : None
#    * certificate_version                   : certificate.version                                   - Certificate.Version | X509Cert.Integer
#    * certificate_file_hash                 : None
#    * certificate_handshake_type            : None
#    * certificate_issuer                    : certificate.issuer                                    - Certificate.Issuer | X509Cert.String
#    * certificate_issuer_common_name        : None
#    * certificate_issuer_email              : None
#    * certificate_issuer_locality           : None
#    * certificate_issuer_organization       : None
#    * certificate_issuer_state              : None
#    * certificate_issuer_street             : None
#    * certificate_issuer_unit               : None
#    * certificate_publickey_algorithm       : certificate.subject_public_key.public_key_algorithm   - Certificate.Subject_Public_Key.Public_Key_Algorithm | X509Cert.SubjectPublicKey.String
#    * certificate_serial                    : certificate.serial_number                             - Certificate.Serial_Number | X509Cert.String
#    * certificate_signature_algorithm       : certificate.signature_algorithm                       - Certificate.Signature_Algorithm | X509Cert.String
#    * certificate_subject                   : certificate.subject                                   - Certificate.Subject | X509Cert.String
#    * certificate_subject_common_name       : None
#    * certificate_subject_email             : None
#    * certificate_subject_locality          : None
#    * certificate_subject_organization      : None
#    * certificate_subject_state             : None
#    * certificate_subject_street            : None
#    * certificate_subject_unit              : None
#    * certificate_supported_next_protocol   : None
#    * certificate_end_time                  : certificate.validity.not_after                        - Certificate.Validity.Not_After | X509Cert.Validity.DateTime
#    * certificate_start_time                : certificate.validity.not_before                       - Certificate.Validity.Not_Before | X509Cert.Validity.DateTime
#    * ip                                    : None
#    * domain                                : None
#
#- WinServiceObj:WindowsServiceObjectType { WinService(WinProcess) }
#    * alias                                 : None
#    * certificate_version                   : None
#    * certificate_file_hash                 : None
#    * certificate_handshake_type            : None
#    * certificate_issuer                    : service_dll_certificate_issuer    - Service_DLL_Certificate_Issuer, String
#    * certificate_issuer_common_name        : None
#    * certificate_issuer_email              : None
#    * certificate_issuer_locality           : None
#    * certificate_issuer_organization       : None
#    * certificate_issuer_state              : None
#    * certificate_issuer_street             : None
#    * certificate_issuer_unit               : None
#    * certificate_publickey_algorithm       : None
#    * certificate_serial                    : None
#    * certificate_signature_algorithm       : None
#    * certificate_subject                   : service_dll_certificate_subject   - Service_DLL_Certificate_Subject, String
#    * certificate_subject_common_name       : None
#    * certificate_subject_email             : None
#    * certificate_subject_locality          : None
#    * certificate_subject_organization      : None
#    * certificate_subject_state             : None
#    * certificate_subject_street            : None
#    * certificate_subject_unit              : None
#    * certificate_supported_next_protocol   : None
#    * certificate_end_time                  : None
#    * certificate_start_time                : None
#    * ip                                    : None
#    * domain                                : None
#    * threat_key                            : None
#    * time                                  : None
##

##
# Key Fields: certificate_serial, certificate_issuer_common_name, 
#   certificate_issuer_email, certificate_issuer_organization, 
#   certificate_issuer_unit, certificate_subject_common_name,
#   certificate_subject_email, certificate_subject_organization, 
#   certificate_subject_unit, certificate_file_hash, ip, domain
##

##
# CIM Mappings to certificate_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   
#   certificate_serial     : Certificates.All_Certificates.ssl_serial
#   certificate_issuer*    : Certificates.All_Certificates.ssl_issuer*
#   certificate_subject*   : Certificates.All_Certificates.ssl_subject*
#   certificate_file_hash  : Certificates.All_Certificates.ssl_hash
##
[certificate_intel]
field.alias                                 = string
field.certificate_version                   = string
field.certificate_file_hash                 = string
field.certificate_handshake_type            = string
field.certificate_issuer                    = string
field.certificate_issuer_common_name        = string
field.certificate_issuer_email              = string
field.certificate_issuer_locality           = string
field.certificate_issuer_organization       = string
field.certificate_issuer_state              = string
field.certificate_issuer_street             = string
field.certificate_issuer_unit               = string
field.certificate_publickey_algorithm       = string
field.certificate_serial                    = string
field.certificate_signature_algorithm       = string
field.certificate_subject                   = string
field.certificate_subject_common_name       = string
field.certificate_subject_email             = string
field.certificate_subject_locality          = string
field.certificate_subject_organization      = string
field.certificate_subject_state             = string
field.certificate_subject_street            = string
field.certificate_subject_unit              = string
field.certificate_supported_next_protocol   = string

## Validity Not After time
field.certificate_end_time                  = time

## Validity Not Before time
field.certificate_start_time                = time

field.description                           = string
field.ip                                    = string
field.domain                                = string
field.threat_key                            = string
field.time                                  = time
field.weight                                = number

##
# OpenIOC Mappings to email_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   alias               : None
#   received_time       : Email.Received
#   src_user            : Email.From
#   actual_src_user     : None
#   recipient           : Email.To
#   actual_recipient    : None
#   subject             : Email.Subject
#   body                : Email.Body
#   embedded_domain     : None
#   embedded_ip         : None
#   file_name           : Email.Attachment/Name
#   file_hash           : None
#   file_size           : Email.Attachment/SizeInBytes
#   attachment_type     : Email.Attachment/MIMEType
#   src                 : Email.ReceivedFromIP
#   threat_key          : Derived from input definition or <links> object in IOC
#   time                : Derived at time the IOC is processed.
##

##
# STIX Mappings to email_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- EmailMessageObj:EmailMessageObjectType { EmailMessage(ObjectProperties) }
#    * alias                 : None
#    * received_time         : header.date                                   - Header.Date | EmailHeader.DateTime
#    * src_user              : header.sender.address_value                   - Header.Sender.Address_Value | EmailHeader.EmailAddress.String
#                            : header.from.address_value                     - Header.From.Address_Value | EmailHeader.EmailAddress.String
#    * actual_src_user       : None
#    * recipient             : header.to                                     - Header.To[i].Address_Value | EmailHeader.EmailRecipients[i].EmailAddress.String
#                            : header.cc                                     - Header.CC[i].Address_Value | EmailHeader.EmailRecipients[i].EmailAddress.String
#                            : header.bcc                                    - Header.BCC[i].Address_Value | EmailHeader.EmailRecipients[i].EmailAddress.String
#    * actual_recipient      : None
#    * subject               : header.subject                                - Header.Subject | EmailHeader.String
#    * body                  : raw_body                                      - Raw_Body | String
#
#    ## embedded_domain, embedded_ip are extracted from the link value provided in the STIX doc, it doesn't provide them seperately.
#    * embedded_domain       : links[i].value                                - Links.Link -> URIObjectType.Value | Links.LinkReference -> URI.AnyURI
#    * embedded_ip           : links[i].value                                - Links.Link -> URIObjectType.Value | Links.LinkReference -> URI.AnyURI
#
#
#    * file_name             : attachments[i].file_name                      - Attachments[i].File->FileObjectType.File_Name | Attachments[i].AttachmentReference->File.String
#    * file_hash             : attachments[i].hashes[i].simple_hash_value    - Attachments[i].AttachmentReference->FileObjectType.Hashes[i].Simple_Hash_Value | Attachments[i].AttachmentReference->File.HashList.HexBinary
#    * file_size             : attachments[i].size_in_bytes                  - Attachments.AttachmentReference->FileObjectType.Size_In_Bytes | Attachments[i].AttachmentReference->File.UnsignedLong
#    * attachment_type       : None
#    * src                   : None
##

##
# Key Fields: src_user, subject, file_name, file_hash, embedded_domain, 
#   embedded_ip, src
##
[email_intel]
field.alias = string
field.received_time         = time

## src_user is the Email Sender
field.src_user              = string

## actual_src_user is the actual Email sender in case of spoofing
field.actual_src_user       = string

field.recipient             = string
field.actual_recipient      = string
field.subject               = string
field.body                  = string
field.embedded_domain       = string
field.embedded_ip           = string
field.file_name             = string
field.file_hash             = string
field.file_size             = string
field.attachment_type       = string

## src is the Received From IP
field.src                   = string

field.description           = string
field.threat_key            = string
field.time                  = time
field.weight                = number

##
# OpenIOC Mappings to file_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   file_name                  : FileItem.FileName
#   file_extension             : FileItem.FileExtension
#   file_path                  : FileItem.FilePath
#   file_path/file_name        : FileItem.FullPath
#   file_hash                  : FileItem.Md5sum
#                                FileItem.Sha1sum
#                                FileItem.Sha256sum
#   file_size                  : FileItem.SizeInBytes
#   threat_key                 : Derived from input definition or <links> object in IOC
#   time                       : Derived at time the IOC is processed.
##

##
# STIX Mappings to file_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- FileObj:FileObjectType { File(ObjectProperties) }
#    * file_name             : file_name                     - File_Name | String
#    * file_extension        : file_extension                - File_Extension | String
#    * file_path             : file_path                     - File_Path | FilePath (Extends String)
#    * file_path/file_name   : full_path                     - Full_Path | String
#    * file_hash             : hashes[i].simple_hash_value   - Hashes[i].Simple_Hash_Value | HashList[i].Hash.HexBinary
#    * file_size             : size_in_bytes                 - Size_In_Bytes | UnsignedLong
##

##
# Key Field: file_hash, file_name
##

##
# CIM Mappings to file_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   
#   file_hash     : Change_Analysis.All_Changes.Endpoint_Changes.Filesystem_Changes.file_hash
#   file_hash     : Email.All_Email.file_hash
#   file_hash     : Malware.Malware_Attacks.file_hash
#   file_hash     : Updates.Updates.file_hash
#   file_name     : Change_Analysis.All_Changes.Endpoint_Changes.Filesystem_Changes.file_name
#   file_name     : Email.All_Email.file_name
#   file_name     : Malware.Malware_Attacks.file_name
#   file_name     : Updates.Updates.file_name
##
[file_intel]
## file_name does include the file extension
field.file_name                 = string

field.file_extension            = string

## file_path should not include file_name
field.file_path                 = string
 
field.file_hash                 = string
field.file_size                 = number

field.description               = string
field.threat_key                = string
field.time                      = time
field.weight                    = number


##
# OpenIOC Mappings to http_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   http_version            : None
#   http_method             : None
#   http_content_type       : None
#   http_referrer           : Network.HTTP_Referr
#   http_user_agent         : Network.UserAgent
#   http_user_agent_length  : None
#   status                  : None
#   cookie                  : None
#   header                  : None
#   data                    : Network.String
#   url                     : Network.URI
#   url_length              : None
#   uri_path                : None
#   uri_query               : None
#   ip                      : None
#   domain                  : Network.DNS
#   threat_key              : Derived from input definition or <links> object in IOC
#   time                    : Derived at time the IOC is processed.
##

##
# STIX Mappings to http_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- NetworkConnectionObj:NetworkConnectionObjectType { NetworkConnection(ObjectProperties) }
#    ## Only if layer7_connections.http_session is not None
#    * ip                    : source_socket_address.ip_address.value        - Source_Socket_Address.IP_Address.Value, SocketAddress.Address.String
#
#- HTTPSessionObj:HTTPSessionObjectType { HTTPSession(ObjectProperties) }
#    * http_version              : http_request_response[i].http_client_request.http_request_line.version                                       - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Line.Version | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestLine.String
#                                : http_request_response[i].http_provisional_server_response.http_status_line.version                           - HTTP_Request_Response[i].HTTP_Provisional_Server_Response.HTTP_Status_Line.Version | HTTPRequestResponse[i].HTTPServerResponse.HTTPStatusLine.String
#                                : http_request_response[i].http_server_response.http_status_line.version                                       - HTTP_Request_Response[i].HTTP_Server_Response.HTTP_Status_Line.Version | HTTPRequestResponse[i].HTTPServerResponse.HTTPStatusLine.String
#
#    * http_method               : http_request_response[i].http_client_request.http_request_line.http_method                                   - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Line.HTTP_Method | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestLine.String
#
#    * http_content_type         : http_request_response[i].http_client_request.http_request_header.parsed_header.content_type                  - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Parsed_Header.Content_Type | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.HTTPRequestHeaderFields.String
#                                : http_request_response[i].http_provisional_server_response.http_response_header.parsed_header.content_type    - HTTP_Request_Response[i].HTTP_Provisional_Server_Response.HTTP_Response_Header.Parsed_Header.Content_Type | HTTPRequestResponse[i].HTTPServerResponse.HTTPResponseHeader.HTTPResponseHeaderFields.String
#                                : http_request_response[i].http_server_response.http_response_header.parsed_header.content_type                - HTTP_Request_Response[i].HTTP_Server_Response.HTTP_Response_Header.Parsed_Header.Content_Type | HTTPRequestResponse[i].HTTPServerResponse.HTTPResponseHeader.HTTPResponseHeaderFields.String
#
#    * http_referrer             : http_request_response[i].http_client_request.http_request_header.parsed_header.referer.value                 - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Parsed_Header.Referer.Value | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.HTTPRequestHeaderFields.URI.String
#
#    * http_user_agent           : http_request_response[i].http_client_request.http_request_header.parsed_header.user_agent                    - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Parsed_Header.User_Agent | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.HTTPRequestHeaderFields.String
#
#    * http_user_agent_length    : None
#
#    * status                    : http_request_response[i].http_provisional_server_response.http_status_line.status_code                       - HTTP_Request_Response[i].HTTP_Provisional_Server_Response.HTTP_Status_Line | HTTPRequestResponse[i].HTTPServerResponse.HTTPStatusLine.PositiveInteger
#                                : http_request_response[i].http_server_response.http_status_line.status_code                                   - HTTP_Request_Response[i].HTTP_Server_Response.HTTP_Status_Line.Status_Code | HTTPRequestResponse[i].HTTPServerResponse.HTTPStatusLine.PositiveInteger
#
#    * cookie                    : http_request_response[i].http_client_request.http_request_header.parsed_header.cookie                        - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Parsed_Header.Cookie | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.HTTPRequestHeaderFields.String
#
#    * header                    : http_request_response[i].http_client_request.http_request_header.raw_header                                  - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Raw_Header | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.String
#                                : http_request_response[i].http_provisional_server_response.http_response_header.raw_header                    - HTTP_Request_Response[i].HTTP_Provisional_Server_Response.HTTP_Response_Header.Raw_Header | HTTPRequestResponse[i].HTTPServerResponse.HTTPResponseHeader.String
#                                : http_request_response[i].http_server_response.http_response_header.raw_header                                - HTTP_Request_Response[i].HTTP_Server_Response.HTTP_Response_Header.Raw_Header | HTTPRequestResponse[i].HTTPServerResponse.HTTPResponseHeader.String
#
#    * data                      : None
#
#    * url                       : None
#
#    * url_length                : None
#
#    * uri_path                  : http_request_response[i].http_client_request.http_request_line.value                                         - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Line.Value | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestLine.String
#
#    * uri_query                 : None
#
#    * ip                        : None
#
#    * domain                    : http_request_response[i].http_client_request.http_request_header.parsed_header.host.domain_name.value        - HTTP_Request_Response[i].HTTP_Client_Request.HTTP_Request_Header.Parsed_Header.Host.Domain_Name.Value | HTTPRequestResponse[i].HTTPClientRequest.HTTPRequestHeader.HTTPRequestHeaderFields.HostField.URI.AnyURI
#
#- URIObj:URIObjectType { URI(ObjectProperties) }
#    * http_version              : None
#    * http_method               : None
#    * http_content_type         : None
#    * http_referrer             : None
#    * http_user_agent           : None
#    * http_user_agent_length    : None
#    * status                    : None
#    * cookie                    : None
#    * header                    : None
#    * data                      : None
#    * url                       : value - if type_ == TYPE_URL ("URL")              - Value | AnyURI
#    * url_length                : None
#    * uri_path                  : None
#    * uri_query                 : None
#    * ip                        : None
#    * domain                    : value - if type_ == TYPE_DOMAIN ("Domain Name")   - Value | AnyURI
##
    
##
# Key Fields: http_user_agent, http_referrer, url, header, ip, domain
##

##
# CIM Mappings to http_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   
#   http_user_agent : Web.Web.http_user_agent
#   http_referrer   : Web.Web.http_referrer
#   http_referrer   : Web.Web.url
#   url             : Web.Web.http_referrer
#   url             : Web.Web.url
##
[http_intel]
field.http_version              = string
field.http_method               = string
field.http_content_type         = string
field.http_referrer             = string
field.http_user_agent           = string
field.http_user_agent_length    = number
field.status                    = number
field.cookie                    = string
field.header                    = string
field.data                      = string
field.url                       = string
field.url_length                = number
field.uri_path                  = string
field.uri_query                 = string
field.ip                        = string
field.domain                    = string
field.description               = string
field.threat_key                = string
field.time                      = time
field.weight                    = number


##
# OpenIOC Mappings to ip_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   ip                   : DnsEntryItem.RecordData/IPv4Address
#   domain               : DnsEntryItem.RecordData/Host
#   address              : None
#   city                 : None
#   country              : None
#   postal_code          : None
#   state_prov           : None
#   organization_name    : None
#   organization_id      : None
#   registration_time    : None
#   threat_key           : Derived from input definition or <links> object in IOC
#   time                 : Derived at time the IOC is processed.
##

##
# STIX Mappings to ip_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- AddressObj:AddressObjectType { Address(ObjectProperties) }
#    * ip                    : address_value, if category == CAT_IPV4 ("ipv4-addr") OR category == CAT_IPV6 ("ipv6-addr") - Address_Value | String
#    * domain                : None
#    * address               : None
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
#
#- DomainNameObj:DomainNameObjectType { DomainName(ObjectProperties) }
#    * ip                    : None
#    * domain                : value     - Value | String
#    * address               : None
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
#
#- WhoisObj:WhoisObjectType { WhoisEntry(ObjectProperties) }
#    * ip                    : ip_address.address_value  - IP_Address.Address_Value | Address.String
#    * domain                : domain_name.value         - Domain_Name.Value | URI.AnyURI
#    * address               : contact_info.address      - Contact_Info.Address | WhoisContact.String                    
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
#
#- SocketAddressObj:SocketAddressObjectType { SocketAddress(ObjectProperties) }
#    * ip                    : ip_address.address_value  - IP_Address.Address_Value | Address.String
#    * domain                : None
#    * address               : None
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
#
#- NetworkSocketObj:NetworkSocketObjectType { NetworkSocket(ObjectProperties) }
#    * ip                    : local_address.ip_address.address_value    - Local_Address.IP_Address.Address_Value, SocketAddress.Address.String
#                            : remote_address.ip_address.address_value   - Remote_Address.IP_Address.Address_Value, SocketAddress.Address.String
#    * domain                : domain                                    - Domain, String
#    * address               : None
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
#
#- DNSRecordObj:DNSRecordObjectType { DNSRecord(ObjectProperties) }
#    * ip                    : ip_address.address_value     - IP_Address.Address_Value, Address.String
#    * domain                : domain_name.value            - Domain_Name.Value, URI.AnyURI
#    * address               : None
#    * city                  : None
#    * country               : None
#    * postal_code           : None
#    * state_prov            : None
#    * oranization_name      : None
#    * organization_id       : None
#    * registration_time     : None
##

##
# Key Fields: ip, domain
##
[ip_intel]
field.ip                        = string
field.domain                    = string
field.description               = string

## IP Location Data
field.address                   = string
field.city                      = string
field.country                   = string
field.postal_code               = string
field.state_prov                = string

## IP Registration Data (Spell these out)
field.organization_name         = string
field.organization_id           = string
field.registration_time         = time

field.threat_key                = string
field.time                      = time
field.weight                    = number

##
# OpenIOC Mappings to process_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   process                                  : ProcessItem.name
#   process_file_path/process_file_name      : ProcessItem.path
#   process_file_name                        : None
#   process_arguments                        : ProcessItem.arguments
#   process_handle_name                      : ProcessItem.HandleList/Handle/Name
#   process_handle_type                      : ProcessItem.HandleList/Handle/Type
#   src                                      : ProcessItem.PortList/PortItem/localIP
#   src_port                                 : ProcessItem.PortList/PortItem/localPort
#   dest                                     : ProcessItem.PortList/PortItem/remoteIP
#   dest_port                                : ProcessItem.PortList/PortItem/remotePort
#   threat_key                               : Derived from input definition or <links> object in IOC
#   time                                     : Derived at time the IOC is processed.
##

##
# STIX Mappings to process_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- ProcessObj:ProcessObjectType { Process(ObjectProperties) }
#    * process               : name                                                              - Name | String
#    * process_file_path     : image_info.path                                                   - Image_Info.Path | ImageInfo.String
#    * process_file_name     : image_info.file_name                                              - Image_Info.File_Name | ImageInfo.String
#    * process_arguments     : argument_list[i]                                                  - Argument_List[i] | ArgumentList[i].String
#    * process_handle_name   : None
#    * process_handle_type   : None
#    * src                   : network_connection_list[i].source_socket_address.ip_address       - Network_Connection_List[i].Source_Socket_Address.IP_Address | NetworkConnectionList[i].NetworkConnection.SocketAddress.Address.String
#    * src_port              : network_connection_list[i].source_socket_address.port             - Network_Connection_List[i].Source_Socket_Address.Port | NetworkConnectionList[i].NetworkConnection.SocketAddress.Port.PositiveInteger
#    * dest                  : network_connection_list[i].destination_socket_address.ip_address  - Network_Connection_List[i].Destination_Socket_Address.IP_Address | NetworkConnectionList[i].NetworkConnection.SocketAddress.Address.String
#    * dest_port             : network_connection_list[i].destination_socket_address.ip_address  - Network_Connection_List[i].Destination_Socket_Address.Port | NetworkConnectionList[i].NetworkConnection.SocketAddress.Port.PositiveInteger
#
#- WinProcessObj:WindowsProcessObjectType { WinProcess(Process) }
#    * process               : name                                                              - Name | String
#    * process_file_path     : image_info.path                                                   - Image_Info.Path | ImageInfo.String
#    * process_file_name     : image_info.file_name                                              - Image_Info.File_Name | ImageInfo.String
#    * process_arguments     : argument_list[i]                                                  - Argument_List[i] | ArgumentList[i].String
#    * process_handle_name   : handle_list[i].name                                        - Handle_List[i].Name | WinHandleList[i].WinHandle.String
#    * process_handle_type   : handle_list[i].type                                         - Handle_List[i].Type | WinHandleList[i].WinHandle.String
#    * src                   : network_connection_list[i].source_socket_address.ip_address       - Network_Connection_List[i].Source_Socket_Address.IP_Address | NetworkConnectionList[i].NetworkConnection.SocketAddress.Address.String
#    * src_port              : network_connection_list[i].source_socket_address.port             - Network_Connection_List[i].Source_Socket_Address.Port | NetworkConnectionList[i].NetworkConnection.SocketAddress.Port.PositiveInteger
#    * dest                  : network_connection_list[i].destination_socket_address.ip_address  - Network_Connection_List[i].Destination_Socket_Address.IP_Address | NetworkConnectionList[i].NetworkConnection.SocketAddress.Address.String
#    * dest_port             : network_connection_list[i].destination_socket_address.ip_address  - Network_Connection_List[i].Destination_Socket_Address.Port | NetworkConnectionList[i].NetworkConnection.SocketAddress.Port.PositiveInteger
##

##
# Key Field: process, process_file_name, process_handle_name, src, dest
##

##
# CIM Mappings to process_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   
#   process : Application_State.All_Application_State.process
##
[process_intel]
field.process                   = string

## process_file_path should not include process_file_name in the path.
field.process_file_path         = string

field.process_file_name         = string

## process_arguments are the arguments passed to the process during execution.
field.process_arguments         = string

field.process_handle_name       = string
field.process_handle_type       = string

## Local IP:Port
field.src                       = string
field.src_port                  = number

## Remote IP:Port
field.dest                      = string
field.dest_port                 = number

field.description               = string
field.threat_key                = string
field.time                      = time
field.weight                    = number


##
# OpenIOC Mappings to registry_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   registry_hive                               : RegistryItem.Hive   
#   registry_path                               : RegistryItem.Path/RegistryItem.KeyPath
#   registry_key_name                           : None
#   registry_value_name                         : RegistryItem.ValueName
#   registry_value_data                         : RegistryItem.Value
#   registry_value_text                         : RegistryItem.Text
#   registry_value_type                         : RegistryItem.Type
#   registry_modified_time                      : RegistryItem.Modified
#   user                                        : RegistryItem.Username
#   threat_key                                  : Derived from input definition or <links> object in IOC
#   time                                        : Derived at time the IOC is processed.
##

##
# STIX Mappings to registry_intel
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- WinRegistryKeyObj:WindowsRegistryKeyObjectType { WinRegistryKey(ObjectProperties) }
#    * registry_hive             : hive                  - Hive | String
#    * registry_path             : key                   - Key | String
#
#    ## registry_key_name would need to be derived from registry_key_path
#    * registry_key_name         : None 
#
#    * registry_value_name       : values[i].name        - Values[i].Name | RegistryValues[i].RegistryValue.String
#    * registry_value_data       : values[i].data        - Values[i].Data | RegistryValues[i].RegistryValue.String
#    * registry_value_text       : None
#    * registry_value_type       : values[i].datatype    - Values[i].Datatype | RegistryValues[i].RegistryValue.String
#    * registry_modified_time    : modified_time         - Modified_Time | DateTime
#    * user                      : None
##

##   
# Key Fields: registry_path, registry_value_name, registry_value_text
##

##
# CIM Mappings to registry_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   Currently we do not have a complete CIM for Registry
#   Data will be acquired via sourcetype=WinRegistry
#   
#   registry_path          : registry_path
#   registry_key_name      : registry_key_name
#   registry_value_name    : registry_value_name
#   registry_value_data    : registry_value_data
#   registry_value_type    : registry_value_type
#   registry_modified_time : _time 
##
[registry_intel]
field.registry_hive             = string

## registry_path may or may not include the key_name at the end
field.registry_path             = string

field.registry_key_name         = string
field.registry_value_name       = string
field.registry_value_data       = string

## registry_value_text is the ASCII representation of registry_value_data
field.registry_value_text       = string

field.registry_value_type       = string
field.registry_modified_time    = time
field.user                      = string

field.description               = string
field.threat_key                = string
field.time                      = time
field.weight                    = number


##
# OpenIOC Mappings to service_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   service                : ServiceItem.name
#   descriptive_name       : ServiceItem.descriptiveName
#   description            : ServiceItem.description
#   status                 : ServiceItem.status
#   service_type           : ServiceItem.type
#   start_mode             : ServiceItem.mode
#   service_file_path      : ServiceItem.path
#   service_file_hash      : ServiceItem.pathmd5sum
#                            ServiceItem.pathsha1sum
#                            ServiceItem.pathsha256sum
#   service_dll_file_path  : ServiceItem.serviceDLL
#   service_dll_file_hash  : ServiceItem.serviceDLLmd5sum
#                            ServiceItem.serviceDLLsha1sum
#                            ServiceItem.serviceDLLsha256sum
#   threat_key             : Derived from input definition or <links> object in IOC
#   time                   : Derived at time the IOC is processed.
##

##
# STIX Mappings to service_intel
#
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- WinServiceObj:WindowsServiceObjectType { WinService(WinProcess) }
#    * service                   : service_name                              - Service_Name | String
#    * descriptive_name          : display_name                              - Display_Name | String
#    * description               : description_list[i] ## List of Strings    - Description_List[i].Description | ServiceDescriptionList[i].String
#    * status                    : service_status                            - Service_Status | String
#    * service_type              : service_type                              - Service_Type | String
#    * start_mode                : startup_type                              - Startup_Type | String
#    * service_file_path         : None
#    * service_file_hash         : None
#    * service_dll_file_Path     : service_dll                               - Service_DLL | String
#    * service_dll_file_hash     : service_dll_hashes[i].simple_hash_value   - Service_DLL_Hashes[i].Simple_Hash_Value | HashList[i].Hash.HexBinary
##

##
# Key Fields: service, service_file_hash, service_dll_file_hash
##

##
# CIM Mappings to service_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   
#   service : Application_State.All_Application_State.Services.service
##
[service_intel]
field.service                   = string
field.descriptive_name          = string
field.description               = string
field.status                    = string
field.service_type              = string
field.start_mode                = string

## service_file_path should not include service_file_name.
field.service_file_path         = string

field.service_file_name         = string

field.service_file_hash         = string

## service_dll_file_path should not include service_dll_file_name.
field.service_dll_file_path     = string

field.service_dll_file_name     = string

field.service_dll_file_hash     = string
field.threat_key                = string
field.time                      = time
field.weight                    = number


[threat_group_intel]
##
# STIX Mappings to threat_group_intel
#
# XSI_NS:XSI_TYPE { <STIX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- ta:ThreatActorType { ThreatActor(stix.Entity) }
#        - threat_group     : title                 - Title, String
#        - threat_category  : types[i].value        - Type[i].Value, List[i].String
#        - description      : short_description     - Short_Description, String
#
#- threat-actor:ThreatActorType { ThreatActor(stix.Entity) }
#       - threat_group      : identity.name         - Identity.Name, Identity.String
#       - threat_category   : None
#       - description       : None
##

## entry create date/time
field.time                  = time

## threat attribution
field.threat_group          = string
field.threat_category       = string
field.description           = string
field.weight                = number

## malware attribution
field.malware_alias         = string

## threat attribution source (ioc)
## source_type (ioc, user-defined, etc.)
field.source_type           = string
## ioc.id or stix:STIX_Package.id
field.source_id             = string
field.source_path           = string
field.source_digest         = string
field.source_status         = string
field.source_processed_time = time

## Acceleration defined on source hash for faster determination
## of whether lookup-generating searches should be executed. 
accelerated_fields.default = {"source_digest": 1}


##
# OpenIOC Mappings to user_intel
#   <collection_field> : <ioc_object>.<ioc_attribute>
#   
#   user        : UserItem.Username
#   full_name   : UserItem.fullname
#   group_name  : UserItem.grouplist/groupname
#   description : UserItem.description
#   threat_key  : Derived from input definition or <links> object in IOC
#   time        : Derived at time the IOC is processed.
#
##

##
# STIX Mappings to user_intel
#
# XSI_NS:XSI_TYPE { <CybOX-Object>(<Parent-Object>) }
#    * <collection_field>    : <object-field>    - <xml_schema_string> | <object-field-type>
#
#- UserAccountObj:UserAccountObjectType { UserAccount(Account) }
#    * user              : username      - Username, String
#    * full_name         : full_name     - Full_Name, String
#    * group_name        : None
#    * description       : description   - Description, String
#
#- WinUserAccountObj:WindowsUserAccountObjectType { WinUser(UserAccount) }
#    * user              : username              - Username, String
#    * full_name         : full_name             - Full_Name, String
#    * group_name        : group_list[i].name    - Group_List[i].Name, WinGroupList[i].WinGroup.String
#    * description       : description           - Description, String
##

##
# Key Fields: user
##

##
# CIM Mappings to user_intel
#   <collection_field> : <cim_model>.<cim_object0>....<cim_objectn>.<cim_attribute>
#   * - indicates tracking is available for matching
#   
#    user : Application_State.All_Application_State.user
#    user : Authentication.Authentication.src_user
#   *user : Authentication.Authentication.user
#    user : Change_Analysis.All_Changes.user
#    user : Change_Analysis.All_Changes.Account_Management.src_user
#   *user : Compute_Inventory.All_Inventory.User.user
#    user : Databases.All_Databases.user
#    user : Email.All_Email.user
#    user : Intrusion_Detection.IDS_Attacks.user
#    user : Malware.Malware_Attacks.user
#    user : Network_Sessions.All_Sessions.user
#    user : Network_Traffic.All_Traffic.user
#    user : Splunk_Audit.Search_Activity.user
#    user : Splunk_Audit.Scheduler_Activity.user
#    user : Splunk_Audit.View_Activity.user
#    user : Ticket_Management.All_Ticket_Management.src_user
#    user : Ticket_Management.All_Ticket_Management.user
#    user : Vulnerabilities.Vulnerabilities.user
#    user : Web.Web.user
#    
##
[user_intel]
field.user                      = string
field.full_name                 = string
field.group_name                = string
field.description               = string
field.threat_key                = string
field.time                      = time
field.weight                    = number
